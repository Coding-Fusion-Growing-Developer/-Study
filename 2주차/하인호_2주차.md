## 관계형 데이터 모델 이론

관계형 데이터 모델 : 데이터를 2차원 테이블 형식으로 정의하고 표현한 모델

릴레이션 : 테이블 형태

- 릴레이션 스키마 : 릴레이션 명 + 어트리뷰트
    - 어트리뷰트 : 릴레이션을 구성하는 각 열
        - 더 이상 쪼갤 수 없는 원자 값으로 구성
        - 순서와 무관하며, 순서가 특별한 의미를 가지지 않는다.
        - 어트리뷰트 명칭은 유니크
        - 어트리뷰트 값은 유니크하지 않아도 됨
- 릴레이션 인스턴스 : 튜플
    - 튜플 : 릴레이션의 각 행
        - 순서와 무관하며, 순서가 특별한 의미를 가지지 않는다.

### 관계형 모델의 키

슈퍼 키

- 튜플을 고유하게 식별 할 수 있는 속성 집합
- 릴레이션은 한 개 이상의 슈퍼 키를 가질 수 있다.
- 유일성을 가짐

후보 키

- 튜플을 고유하게 식별 할 수 있는 최소한의 속성 집합
- 유일성, 최소성을 가짐

기본 키

- 후보 키 중에 선택된 키

대체 키

- 후보 키 중에 선택되지 않은 키

외래 키

- 다른 릴레이션에 속한 어트리뷰트의 기본 키를 참조하는 키
- NULL 가능
- 중복된 튜플 가능

### 제약조건

키 제약조건

- 키는 유일하게 식별할 수 있는 어트리뷰트들로 구성
- 다른 튜플의 키 값과 중복 금지

실체무결성

- 기본키를 구성하는 모든 어트리뷰트는 NULL 안됨
- 릴레이션 내에서 오직 하나의 값만 존재해야한다 = 중복값 금지

영역무결성

- 값은 정의된 도메인에 속한 값 = 타입, 범위 일치

참조무결성

- 외래 키 사용시 기본키 값을 사용
- 외래키 사용시 일관성 유지

### 함수 종속

함수종속성

- 어느 속성군의 값이 정해지면 다른 속성군의 값이 정해지는 것
- A,B가 관계 R의 속성일때, A값이 하나의 B 값에 대응, B값이 여러개의 A값에 대응시 **B는 A에 함수 종속**이라고 한다.(표기법 : A→B)
- A는 결정자, B는 종속자
- EX) 고객번호 → (고객명, 생년월일, 전화번호, 주소)

완전 함수종속

- X에 대해 Y가 함수적으로 종속되나, X의 부분 집합(X가 속성들의 집합일때 이것의 부분 집합)에 대하여서는 함수적으로 종속하지 않은 경우 Y는 X에 대하여 완전 함수종속
- EX) (주문번호 + 상품코드) → 주문수량, 주문번호 -/> 주문수량

부분 함수종속

- 기본키의 일부 속성만으로도 종속관계가 결정되는 경우
- EX)
    - 기본키 = 주문번호, 상품코드
    - 상품코드 → 상품단가

이행적 함수종속

- X→Y, Y→Z 이면 X→Z 인데 이 경우 Z는 X에 이행적 함수종속성을 갖는다.
- EX)
    - 주문번호 → 고객번호, 고객번호 → 고객명

### 정규화

정규화

- 데이터를 입력 수정 삭제할때 발생하는 이상 현상을 최소화하기 위해 좀 더 작은 단위의 테이블로 설계하는 과정

정규화 장점

- 이상 현상 최소화
- 종속성이 강한 데이터 요소들을 분리하여 독립된 개념으로 정의
    - 높은 응집력과 낮은 결합도 원칙에 충실
    - 유연성 증가
- 세분화하여 재활용성 높아짐
- 중복 최소화
    - 데이터 품질 문제 줄임
    - 저장공간 최소화
- 입력, 수정, 삭제 작업 최소화
    - 수행속도 향상

과도한 정규화시

- join이 빈번하게 발생하여 성능 저하 가능
- join이 발생하는 것은 맞지만 성능 저하는 데이터베이스 특성을 고려하지 않고 사용할때 발생하는 것

질문 : join이 빈번하다는 기준이 뭘까요?

질문 : 데이터베이스 특성을 고려하지 않고 사용한다는 예시가 있나요?

반정규화

- 제한적으로 사용해야함
- 이상현상 발생하지 않도록 노력 필요

질문 : 반정규화는 언제 사용해야할까요?

제1정규형

- 테이블에 중복되는 행이 없고 == 행이 중복되지 않도록 기본 키 지정
- 모든 열의 값은 원자 값 == 개념적으로 중복열 없고 다중값 발생안됨

원자성에 대한 기준

- 기준이 좀 모호함
- 주소는 나누기에 따라 쪼개기 가능
- 업무를 처리하는 기준에 따라 바뀔 수 있음

질문 : 나중에 쪼개질 수도 있고 안쪼개질 수도 있다면 어떻게 하는 것이 좋을까요?

제2정규형

- 키가 아닌 어트리뷰트는 후보키 전체에 종속
    - 그렇지 않다면 별도의 테이블로 분리

제3정규형

- 키가 아닌 어트리뷰트들 간에 서로 종속적이지 않음
    - 그렇다면 별도의 테이블로 분리

연결함정

- 모호한 관계가 발생하는 현상
- 무손실 분해의 원칙이 지켜지지 않아 원래 있던 관계성을 잃어 버리는 현상

모호성 형태

- 부채꼴 함정
    - M:N 관계 해결시 1:M 잘못된 방향으로 추가 시 발생
    - 재설정 하여 해결
- 균열 함정
    - 관계가 누락된 경우 발생
    - 누락된 관계를 추가하여 해결
    - EX) 회사 - 공급사 - 물품 에서 공급사 없이 구매한 물품
        - 회사 - 물품 관계 추가하여 해결
        - 이게 좋은 해결 방법인가…??
            - 물품에 공급사 fk 컬럼과 회사 fk 컬럼이 모두 존재?
            - 회사 물품 관계가 존재할 시에 혼란 유발 가능
            - 차라리 직접 구매 물품 테이블 추가

## 데이터 모델링 접근 방법

현행 분석 및 방향성 수립

- 현행 업무 분석
    - 업무 지식 습득
    - 업무 특성, 흐름 파악
    - → 문제점 및 개선방안 도출
- 현행 데이터 분석
    - ERD 등 수집하여 분석
    - 실제 데이터 분석
    - 데이터 구조, 성능 이슈 위주 분석
- 요구사항정의
    - 요구사항 수집
    - 담당자와 인터뷰 통해 요구사항 상세화

현업담당자와 협업하여 모델링

- 이를 위해 모델러는 업무에 대한 기본적인 이해가 필수
- 현업담당자는 ER 표기법 등의 모델링 관련 교육 필요

문서를 통한 업무 요건 파악

- 문서화가 잘 되어 있는 경우 문서를 사용하여 파악
- 전적으로 문서에 의존하기 보다는 보조 수단으로 사용

리버스 모델 활용

- ERD가 없다면 DB 메타정보 이용하여 ERD 작성

리버스 모델링

- 전체 엔티티를 한번에 이해하려면 복잡함
- 업무나 주제영역 또는 테이블 owner 단위로 작업을 나누면 이해하기 쉽다.
- 리버스 모델링을 할 대상도 잘 선정하여 효율적으로 진행
- 테이블명이 유사하거나, 특정 컬럼이 있는 테이블끼리 분리하여 작은 단위로 나누어 수행